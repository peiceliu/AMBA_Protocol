# AHB-lite 2 APB Bridge DS doc

作者：钟坤岑

日期：2024.12.19

文档版本：ver 0.1

| 日期       | 修订版本 | 描述         | 作者   |
| ---------- | -------- | ------------ | ------ |
| 2024.12.19 | ver 0.1  | 撰写部分文档 | 钟坤岑 |
|            |          |              |        |
|            |          |              |        |

## 概述

本设计为AHB-lite总线与APB总线之间的转接桥，为AHB slave / APB master

## 接口图

![v2d48973dfdba60aaa12f92fd795723d871440w](https://pic4.zhimg.com/v2-d48973dfdba60aaa12f92fd795723d87_1440w.jpg)

## 信号列表

| 系统信号  | 方向 | 位宽 | 描述                                                                                                                                                                                              |
| --------- | ---- | ---- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| HCLK      | I    | 1    | 同步桥 AHB 和 APB 的同步时钟                                                                                                                                                                      |
| HRESETn   | I    | 1    | 同步桥 AHB 和 APB 的同步复位                                                                                                                                                                      |
| PCLKEN    | I    | 1    | PCLK 的使能信号。通常当HCLK = PCLK ，PCLEN为1 ；                                                                                                                                                  |
| APBACTIVE | O    | 1    | 指示 APB 桥工作信号，可以应用于后级 APB BUS 上的 CLK GATE：`<br>`APBACTIVE = 1, 说明此时同步桥处于工作状态，有信号在AHB和APB之间传输 APBACTIVE可以用作APB子系统时钟门控信号，供外设做低功耗处理 |

| AHB 信号  | 方向 | 位宽 | 描述                                                                                                                      |
| --------- | ---- | ---- | ------------------------------------------------------------------------------------------------------------------------- |
| HSEL      | I    | 1    | 每个 AHB 从机的选通信号。每个从机有自己独立的从机选择信号，并用该信号，表示当前传输是否选中该从机，一般是地址信号的译码。 |
| HADDR     | I    | 16   | AHB 16 bit 地址总线                                                                                                       |
| HTRANS    | I    | 2    | AHB 的传输类型，IDLE, BUSY, NONSEQ, SEQ 四种传输类型。                                                                    |
| HSIZE     | I    | 3    | AHB 每一个 transfer 传输数据的大小，以字节为单位。最高1024                                                                |
| HPROT     | I    | 4    | AHB 保护控制信号，需要 slave 带有保护功能，一般不作使用。主要给希望执行保护级别的模块使用。                               |
| HWRITE    | I    | 1    | AHB 写信号，高为写，低为读                                                                                                |
| HWDATA    | I    | 32   | AHB 写数据                                                                                                                |
| HREADY    | I    | 1    | AHB 总线从机的输入 ready 信号，通常为仲裁器拉取所有的ready_out判断而成                                                    |
| HRDATA    | O    | 32   | AHB 读数据                                                                                                                |
| HREADYOUT | O    | 1    | AHB 桥输出的 ready 信号，一般与 HREADY 对应。                                                                             |
| HRESP     | O    | 1    | AHB 状态相应信号。OKAY、ERR                                                                                               |

| APB 信号 | 方向 | 位宽 | 描述                                           |
| -------- | ---- | ---- | ---------------------------------------------- |
| PADDR    | O    | 16   | APB 地址信号                                   |
| PENABLE  | O    | 1    | APB 使能信号                                   |
| PWRITE   | O    | 1    | APB 写信号，高为写，低为读                     |
| PSTRB    | O    | 4    | APB 写选通信号，表示哪个字节有效  （APB4）    |
| PPROT    | O    | 3    | APB Slave 的保护类型。提供保护机制  （APB4） |
| PWDATA   | O    | 32   | APB 写数据                                     |
| PSEL     | O    | 1    | APB 的设备的选通有效信号                       |
| PRDATA   | I    | 32   | APB 读数据                                     |
| PREADY   | I    | 1    | APB ready 信号  （APB3）                     |
| PSLVERR  | I    | 1    | APB 传输错误信号  （APB3）                   |

## 其他参数

| ADDRWIDTH      | 16  | 地址空间，寻址64KB                                         |
| -------------- | --- | ---------------------------------------------------------- |
| REGISTER_WDATA | 1/0 | 为1则寄存写数据（3 clk cycles），0则不寄存（2 clk cycles） |
| REGISTER_RDATA | 1/0 | 为1则寄存读数据（3 clk cycles），0则不寄存（2 clk cycles） |
