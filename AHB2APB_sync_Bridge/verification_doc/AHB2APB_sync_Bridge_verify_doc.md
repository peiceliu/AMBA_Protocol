[TOC]

# AHB2APB_sync_Bridge模块UT验证报告

作者：刘培策

日期：2024/12/18

文档版本：v0.1



## 修订记录

| 日期      | 修订版本 | 描述                     | 作者 |
| --------- | -------- | ------------------------ | ---- |
| 2024-12-18| V0.1     | 初始化验证报告            | 刘培策|
| 2024-12-26| V0.2     | 添加验证思路              | 刘培策|
|           |          |                          |      |
|           |          |                          |      |

## 引言

*（本章节目的：让评审人员快速获取DUT的大概功能）*

*（环境背景描述，简要描述仿真测试情况。包括：待测模块或项目，测试级别等；）*

*（测试对象描述：若测试对象为基于协议的模块，简要描述协议。需测试内容：若测试对象为项目，则描述需测试的大体指标）*

*（可能涉及到的使用背景描述：若测试对象需面向某些特殊应用场景，且必须进行针对性测试的，也需要描述出来）*

*（基于测试对象及必要背景采用的测试策略的描述：简述为了达到测试目的，需采取的测试措施，包括搭建的测试环境架构、能够覆盖的测试内容、不能覆盖的内容，以及对不能覆盖内容的补偿措施等。）*

待测模块为AHB转APB同步桥接模块，该DUT在AHB bus中等效于一个AHB_slave，在APB bus中等效于一个APB_master。
该模块的Spec源于ARM公司官网中相关AHB-to-APB-sync-bridge官方描述。涉及到的背景知识：AHB/APB协议。
验证策略采用定向测试及随机约束测试，与此同时，根据DUT的源码结构层次，在top.sv中插入SVA断言确保DUT的功能符合官方协议标准。


## 验证策略

### 模块主体功能概述

*（当前模块的主体功能描述。尽量以框图+文字的方式给出）*

### 验证思路

*（针对上一章节的主体功能，如何保证验证的充分性和完备性等，验证的思路描述。）*
该模块主要的功能为：将AHB Bus上的read/write transfer转换为APB Bus上的read/write transfer。
reference model需要实现与DUT一样的功能，初步想法为：
1. 使用ahb_master_monitor采集相关AHB master传输到AHB2APB_sync_Bridge的有效数据
2. 使用apb_slave_monitor采集相关APB slave传输到AHB2APB_sync_Bridge的有效数据
3. 使用output_monitor采集AHB2APB_sync_Bridge的输出结果，即AHB2APB_sync_Bridge传输给APB slave、AHB master的数据。
4. 将以上全部数据送到reference model进行处理
5. 将rm处理后的数据送到scoreboard，与DUT的输出结果进行比对

更为具体的：
1. 需要确定每个monitor在什么condition下采集的数据才是有效的
2. reference model 需要判断当前AHB master的transfer是read or write。
如果是write说明当前为AHB write transfer转换为 APB write transfer，reference model需要给出PWRITE == 1； PWDATA == HWDATA；PADDR == HADDR；
如果是read说明当前为AHB read transfer转换为 APB read transfer，reference model需要给出PWRITE == 0；HRDATA == PRDATA；PADDR == HADDR；
3. 此外需要注意AHB BUS 为流水线设计，即分为地址/数据两个阶段。第一个阶段为address，第二个阶段为data。


定向测试：采用一些固定激励且知道预期结果的简单测试用例，通过观察波形来确定是否Pass。
随机约束测试：采用全随机的测试用例进行仿真，通过reference model与scoreboard来确定是否Pass。
SVA断言：对一些控制信号的逻辑以及数据/地址需要保持不变的阶段设置System Verilog Assertion断言来确定是否符合规范。

### 验证平台介绍

*（验证平台描述可来源自验证方案，但需要把实际落地后添加的组件、激励等补充进去，本章节重点介绍验证平台的实际构成，工作流程，以及如何支撑你的验证策略。）*

 

## 测试用例记录

表1 测试用例描述

| 测试用例   | 测试目的          | 用例配置描述                                                 | 仿真结果                                                     |
| ---------- | ----------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| *my_case5* | *LCD接口随机测试* | *row：100之间随机；行列值28到4096范围内；col：800之间随机；sample_rate：默认值；在LCD内部fix_cfg_sel：默认值；viu_model：默认值；需确认；共两种，需遍历；lcd_thbp=5；lcd_thfp=6；lcd_thw=1；lcd_tvbp=3；lcd_tvfp=4；lcd_tvw=2；HV极性四种全覆盖，并随机设计提供异常情况列表，供验证参考* | *PASS。仿真结束条件触发；全部比对结果正确；断言结果检测正确；等等* |
| my_case1   | 验证平台冒烟测试    | 空(仅用来测试验证平台基本组件是否存在error)                    |                                    |
|            |                   |                                                              |                                    |
|            |                   |                                                              |                                    |
|            |                   |                                                              |                                    |

## 覆盖率报告

### 功能覆盖率报告

*整体功能覆盖率截图并说明，与测试点分解结果的对应关系*

### 代码覆盖率报告

*无法覆盖的代码，需截图，说明；*

### 条件覆盖率报告

*无法覆盖的条件，需截图，说明；*

### 状态机覆盖率报告

*按需添加*

 

## 典型BUG记录

*记录验证过程中收集到的典型BUG，发现过程及解决方案等*
| 日期 | Bug说明 | 发现过程 | bug hash | 解决方案 | 解决后commit hash |
| ---- | ------ | ------- | --------- | -------- | ---------------- |
| 2024-12-27        |仿真时间超时导致uvm_fatal|尝试将pclken一直置1(即PCLK==HCLK的情况)运行case3仿真超时报错|145e0a80d5684b35d80db3eb8072e32558e8e9ff|在apb_slave_driver中相关逻辑应该为vif.clk写成了vif.pclken,进行改正重新仿真正常|                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
|                   |                   |                               |           |                                       |                  |
 

## 验证结果及结论

总结整个验证活动，是否达到出口条件等；